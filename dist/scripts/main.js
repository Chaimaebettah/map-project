"use strict";function googleError(){var n="Google Maps currently unavailable. Check internet or try later";document.getElementById("map").innerHTML=n,console.log(n),alert(n)}function googleSucces(){function n(n,e,a){var o=e.myLatLng,i=a;i||(i='<div class="content"><p>this is '+e.name+"  </p>"+o.lat+" "+o.lng+"</div>");var r=new google.maps.InfoWindow({content:i});c.push(r);var l=new google.maps.Marker({position:o,map:n,title:e.name,draggable:!1,animation:google.maps.Animation.DROP});return l.addListener("click",function(){c.forEach(function(n){n.close()}),r.open(n,l),t(l)}),l}function t(n){null!==n.getAnimation()?n.setAnimation(null):(n.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){t(n)},1400))}function e(n,t){return t.forEach(function(t){t.setMap(n)}),t}function a(n){return n.forEach(function(n){n.setMap(null)}),[]}function o(){var n=document.getElementById("map");r=new google.maps.Map(n,{center:l,zoom:4})}function i(t){function e(e){if(!e)return void s.push(n(r,t));var a='<div class="content">';if(e.error&&e.error.info)return alert(e.error.info),a;var o,i=e[1];if(i.length>0){for(var l=0;l<i.length;l++){o=i[l];var c="http://en.wikipedia.org/wiki/"+o;a+=t.name+"<p>"+e[2]+'</p><a href=" '+c+'">'+c+"</a>"}a+="</div>",a+='<h3 class="location-name">'+t.name+"</h3>"}else a='<div class="content">'+t.name+"<p>No articles found on Wikipedia</p></div>",s.push(n(r,t,a));return a}function a(e,a){if(!e||!a)return void s.push(n(r,t));if(e.meta.errorDetail)return s.push(n(r,t)),void alert(e.meta.errorDetail);var o=a;e.response.venues.length&&e.response.venues.forEach(function(n){o+='<li class="venue-style">'+n.name+"<br>Address: "+n.location.formattedAddress+"</li>",n.categories.forEach(function(n){o+="<img  src="+n.icon.prefix+"bg_64"+n.icon.suffix+" />"})}),s.push(n(r,t,o))}var o="N2FFM3D25CFAUDWCU5AQFSCKPKEHXI142VVHRNBUHWX0JIKK",i="R54NBKMBB3M534D4I5ACHMTPUU5CMILIC4UI21JW2BGOREFC",l="http://en.wikipedia.org/w/api.php?action=opensearch&format=json&search="+t.name+"&limit=1&redirects=return&format=json",c="https://api.foursquare.com/v2/venues/search?client_id="+o+"&client_secret="+i+"&v=20130815&limit=4&ll="+t.myLatLng.lat+","+t.myLatLng.lng+"&query=Shopping",u=$.ajax({url:l,dataType:"jsonp",timeout:3e3}),m=$.ajax({url:c,dataType:"jsonp",timeout:3e3});Promise.all([u,m]).then(function(n){a(n[1],e(n[0]))})["catch"](function(){console.log("here"),a(null,e(null)),$("body").append('<div class="api-alert">could not get additional data for locations</div>'),setTimeout(function(){$(".api-alert").remove()},4e3)})}var r,l={lat:41.4173,lng:-90.9071},s=[],c=[];o();var u=[{id:1,name:"New York",myLatLng:{lat:40.73061,lng:-73.935242}},{id:2,name:"NewPort",myLatLng:{lat:41.490102,lng:-71.312829}},{id:3,name:"Nova Scotia ",myLatLng:{lat:44.681987,lng:-63.744311}},{id:4,name:"Gjelina",myLatLng:{lat:33.99059,lng:-118.464999}},{id:5,name:"Ohio",myLatLng:{lat:40.4173,lng:-82.9071}},{id:6,name:"Chicago",myLatLng:{lat:41.8781,lng:-87.6298}},{id:7,name:"Boston",myLatLng:{lat:42.364506,lng:-71.038887}},{id:8,name:"Montana",myLatLng:{lat:46.8797,lng:-110.3626}},{id:9,name:"Nebraska",myLatLng:{lat:41.4925,lng:-99.9018}},{id:10,name:"Colorado",myLatLng:{lat:39.5501,lng:-105.7821}},{id:11,name:"Canada",myLatLng:{lat:56.1304,lng:-106.3468}}],m={query:ko.observable(""),locationListIsOpen:ko.observable(!1)};m.toggleList=function(){this.locationListIsOpen(!this.locationListIsOpen())},m.focusLocation=function(n){c.forEach(function(e,a){e.close();var o=n.id-1;if(o===a){var i=o,l=s[i];e.open(r,l),t(l)}})},m.showList=ko.computed(function(){return this.locationListIsOpen()?"on":"off"},m),m.arr=ko.computed(function(){var n=this.query().toLowerCase(),t=ko.utils.arrayFilter(u,function(t){return t.name.toLowerCase().indexOf(n)>=0});return s=a(s),t.forEach(function(n){i(n)}),e(r,s),t},m),ko.applyBindings(m)}